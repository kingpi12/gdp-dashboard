[1mdiff --git a/requirements.txt b/requirements.txt[m
[1mindex a930bdb..9f0de5b 100644[m
[1m--- a/requirements.txt[m
[1m+++ b/requirements.txt[m
[36m@@ -1,2 +1,5 @@[m
[31m-streamlit[m
[31m-pandas[m
[32m+[m[32mstreamlit==1.28.0[m
[32m+[m[32mpandas==2.1.0[m
[32m+[m[32mplotly==5.15.0[m
[32m+[m[32mopenpyxl==3.1.0[m
[32m+[m[32mnumpy==1.24.0[m
\ No newline at end of file[m
[1mdiff --git a/streamlit_app.py b/streamlit_app.py[m
[1mindex c2b31bc..6db94a2 100644[m
[1m--- a/streamlit_app.py[m
[1m+++ b/streamlit_app.py[m
[36m@@ -1,151 +1,927 @@[m
 import streamlit as st[m
 import pandas as pd[m
[31m-import math[m
[31m-from pathlib import Path[m
[31m-[m
[31m-# Set the title and favicon that appear in the Browser's tab bar.[m
[31m-st.set_page_config([m
[31m-    page_title='GDP dashboard',[m
[31m-    page_icon=':earth_americas:', # This is an emoji shortcode. Could be a URL too.[m
[31m-)[m
[31m-[m
[31m-# -----------------------------------------------------------------------------[m
[31m-# Declare some useful functions.[m
[31m-[m
[31m-@st.cache_data[m
[31m-def get_gdp_data():[m
[31m-    """Grab GDP data from a CSV file.[m
[31m-[m
[31m-    This uses caching to avoid having to read the file every time. If we were[m
[31m-    reading from an HTTP endpoint instead of a file, it's a good idea to set[m
[31m-    a maximum age to the cache with the TTL argument: @st.cache_data(ttl='1d')[m
[31m-    """[m
[31m-[m
[31m-    # Instead of a CSV on disk, you could read from an HTTP endpoint here too.[m
[31m-    DATA_FILENAME = Path(__file__).parent/'data/gdp_data.csv'[m
[31m-    raw_gdp_df = pd.read_csv(DATA_FILENAME)[m
[31m-[m
[31m-    MIN_YEAR = 1960[m
[31m-    MAX_YEAR = 2022[m
[31m-[m
[31m-    # The data above has columns like:[m
[31m-    # - Country Name[m
[31m-    # - Country Code[m
[31m-    # - [Stuff I don't care about][m
[31m-    # - GDP for 1960[m
[31m-    # - GDP for 1961[m
[31m-    # - GDP for 1962[m
[31m-    # - ...[m
[31m-    # - GDP for 2022[m
[31m-    #[m
[31m-    # ...but I want this instead:[m
[31m-    # - Country Name[m
[31m-    # - Country Code[m
[31m-    # - Year[m
[31m-    # - GDP[m
[31m-    #[m
[31m-    # So let's pivot all those year-columns into two: Year and GDP[m
[31m-    gdp_df = raw_gdp_df.melt([m
[31m-        ['Country Code'],[m
[31m-        [str(x) for x in range(MIN_YEAR, MAX_YEAR + 1)],[m
[31m-        'Year',[m
[31m-        'GDP',[m
[31m-    )[m
[31m-[m
[31m-    # Convert years from string to integers[m
[31m-    gdp_df['Year'] = pd.to_numeric(gdp_df['Year'])[m
[31m-[m
[31m-    return gdp_df[m
[31m-[m
[31m-gdp_df = get_gdp_data()[m
[31m-[m
[31m-# -----------------------------------------------------------------------------[m
[31m-# Draw the actual page[m
[31m-[m
[31m-# Set the title that appears at the top of the page.[m
[31m-'''[m
[31m-# :earth_americas: GDP dashboard[m
[31m-[m
[31m-Browse GDP data from the [World Bank Open Data](https://data.worldbank.org/) website. As you'll[m
[31m-notice, the data only goes to 2022 right now, and datapoints for certain years are often missing.[m
[31m-But it's otherwise a great (and did I mention _free_?) source of data.[m
[31m-'''[m
[31m-[m
[31m-# Add some spacing[m
[31m-''[m
[31m-''[m
[31m-[m
[31m-min_value = gdp_df['Year'].min()[m
[31m-max_value = gdp_df['Year'].max()[m
[31m-[m
[31m-from_year, to_year = st.slider([m
[31m-    'Which years are you interested in?',[m
[31m-    min_value=min_value,[m
[31m-    max_value=max_value,[m
[31m-    value=[min_value, max_value])[m
[31m-[m
[31m-countries = gdp_df['Country Code'].unique()[m
[31m-[m
[31m-if not len(countries):[m
[31m-    st.warning("Select at least one country")[m
[31m-[m
[31m-selected_countries = st.multiselect([m
[31m-    'Which countries would you like to view?',[m
[31m-    countries,[m
[31m-    ['DEU', 'FRA', 'GBR', 'BRA', 'MEX', 'JPN'])[m
[31m-[m
[31m-''[m
[31m-''[m
[31m-''[m
[31m-[m
[31m-# Filter the data[m
[31m-filtered_gdp_df = gdp_df[[m
[31m-    (gdp_df['Country Code'].isin(selected_countries))[m
[31m-    & (gdp_df['Year'] <= to_year)[m
[31m-    & (from_year <= gdp_df['Year'])[m
[31m-][m
[31m-[m
[31m-st.header('GDP over time', divider='gray')[m
[31m-[m
[31m-''[m
[31m-[m
[31m-st.line_chart([m
[31m-    filtered_gdp_df,[m
[31m-    x='Year',[m
[31m-    y='GDP',[m
[31m-    color='Country Code',[m
[31m-)[m
[31m-[m
[31m-''[m
[31m-''[m
[31m-[m
[31m-[m
[31m-first_year = gdp_df[gdp_df['Year'] == from_year][m
[31m-last_year = gdp_df[gdp_df['Year'] == to_year][m
[31m-[m
[31m-st.header(f'GDP in {to_year}', divider='gray')[m
[31m-[m
[31m-''[m
[31m-[m
[31m-cols = st.columns(4)[m
[31m-[m
[31m-for i, country in enumerate(selected_countries):[m
[31m-    col = cols[i % len(cols)][m
[31m-[m
[31m-    with col:[m
[31m-        first_gdp = first_year[first_year['Country Code'] == country]['GDP'].iat[0] / 1000000000[m
[31m-        last_gdp = last_year[last_year['Country Code'] == country]['GDP'].iat[0] / 1000000000[m
[31m-[m
[31m-        if math.isnan(first_gdp):[m
[31m-            growth = 'n/a'[m
[31m-            delta_color = 'off'[m
[32m+[m[32mimport numpy as np[m
[32m+[m[32mfrom datetime import datetime[m
[32m+[m[32mimport io[m
[32m+[m[32mimport re[m
[32m+[m
[32m+[m[32m# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã[m
[32m+[m[32mst.set_page_config(page_title="–ê–Ω–∞–ª–∏–∑ –ø–æ–∂–∞—Ä–æ–≤", page_icon="üî•", layout="wide")[m
[32m+[m
[32m+[m[32m# –ü—Ä–æ–±—É–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏[m
[32m+[m[32mtry:[m
[32m+[m[32m    import plotly.express as px[m
[32m+[m[32m    import plotly.graph_objects as go[m
[32m+[m[32m    PLOTLY_AVAILABLE = True[m
[32m+[m[32mexcept ImportError:[m
[32m+[m[32m    PLOTLY_AVAILABLE = False[m
[32m+[m[32m    st.warning("Plotly –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install plotly")[m
[32m+[m
[32m+[m[32mtry:[m
[32m+[m[32m    import openpyxl[m
[32m+[m[32m    OPENPYXL_AVAILABLE = True[m
[32m+[m[32mexcept ImportError:[m
[32m+[m[32m    OPENPYXL_AVAILABLE = False[m
[32m+[m[32m    st.warning("Openpyxl –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install openpyxl")[m
[32m+[m
[32m+[m[32m# –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤[m
[32m+[m[32mdef create_chart(data, chart_type='line', **kwargs):[m
[32m+[m[32m    """–£–º–Ω—ã–π —Å–æ–∑–¥–∞—Ç–µ–ª—å –≥—Ä–∞—Ñ–∏–∫–æ–≤ —Å fallback"""[m
[32m+[m[32m    if PLOTLY_AVAILABLE and not data.empty:[m
[32m+[m[32m        return create_plotly_chart(data, chart_type, **kwargs)[m
[32m+[m[32m    else:[m
[32m+[m[32m        return create_simple_chart(data, chart_type, **kwargs)[m
[32m+[m
[32m+[m[32mdef create_plotly_chart(data, chart_type, **kwargs):[m
[32m+[m[32m    """–°–æ–∑–¥–∞–Ω–∏–µ Plotly –≥—Ä–∞—Ñ–∏–∫–æ–≤"""[m
[32m+[m[32m    try:[m
[32m+[m[32m        if chart_type == 'line' and not data.empty:[m
[32m+[m[32m            fig = px.line(data, x=kwargs.get('x'), y=kwargs.get('y'),[m[41m [m
[32m+[m[32m                         title=kwargs.get('title'), template='plotly_white')[m
[32m+[m[32m            fig.update_layout(xaxis_title=kwargs.get('x'), yaxis_title=kwargs.get('y'))[m
[32m+[m[32m            return st.plotly_chart(fig, use_container_width=True)[m
[32m+[m[41m        [m
[32m+[m[32m        elif chart_type == 'bar' and not data.empty:[m
[32m+[m[32m            fig = px.bar(data, x=kwargs.get('x'), y=kwargs.get('y'),[m
[32m+[m[32m                        title=kwargs.get('title'), orientation=kwargs.get('orientation'),[m
[32m+[m[32m                        template='plotly_white')[m
[32m+[m[32m            return st.plotly_chart(fig, use_container_width=True)[m
[32m+[m[41m        [m
[32m+[m[32m        elif chart_type == 'pie' and not data.empty:[m
[32m+[m[32m            fig = px.pie(data, names=kwargs.get('names'), values=kwargs.get('values'),[m
[32m+[m[32m                        title=kwargs.get('title'))[m
[32m+[m[32m            return st.plotly_chart(fig, use_container_width=True)[m
[32m+[m[41m            [m
[32m+[m[32m    except Exception as e:[m
[32m+[m[32m        st.error(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞: {e}")[m
[32m+[m[32m        return create_simple_chart(data, chart_type, **kwargs)[m
[32m+[m
[32m+[m[32mdef create_simple_chart(data, chart_type, **kwargs):[m
[32m+[m[32m    """–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –∏–ª–∏ —Ç–∞–±–ª–∏—Ü"""[m
[32m+[m[32m    try:[m
[32m+[m[32m        if chart_type == 'line' and not data.empty and kwargs.get('y') in data.columns:[m
[32m+[m[32m            st.line_chart(data[kwargs.get('y')])[m
[32m+[m[32m        elif chart_type == 'bar' and not data.empty and kwargs.get('y') in data.columns:[m
[32m+[m[32m            st.bar_chart(data[kwargs.get('y')])[m
[32m+[m[32m        else:[m
[32m+[m[32m            st.dataframe(data)[m
[32m+[m[32m    except Exception as e:[m
[32m+[m[32m        st.error(f"–û—à–∏–±–∫–∞ –ø—Ä–æ—Å—Ç–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞: {e}")[m
[32m+[m[32m        st.dataframe(data)[m
[32m+[m
[32m+[m[32m# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö[m
[32m+[m[32mdef load_data(uploaded_file):[m
[32m+[m[32m    """–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel —Ñ–∞–π–ª–∞"""[m
[32m+[m[32m    try:[m
[32m+[m[32m        if OPENPYXL_AVAILABLE:[m
[32m+[m[32m            df = pd.read_excel(uploaded_file, engine='openpyxl')[m
[32m+[m[32m        else:[m
[32m+[m[32m            df = pd.read_excel(uploaded_file)[m
[32m+[m[41m        [m
[32m+[m[32m        # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö[m
[32m+[m[32m        df = preprocess_data(df)[m
[32m+[m[32m        return df[m
[32m+[m[32m    except Exception as e:[m
[32m+[m[32m        st.error(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: {e}")[m
[32m+[m[32m        return None[m
[32m+[m
[32m+[m[32mdef preprocess_data(df):[m
[32m+[m[32m    """–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –≤–∞—à–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π"""[m
[32m+[m[32m    # –ü—Ä–∏–≤–æ–¥–∏–º –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞[m
[32m+[m[32m    df.columns = df.columns.str.lower().str.strip()[m
[32m+[m[41m    [m
[32m+[m[32m    # –°–æ–∑–¥–∞–µ–º –∫–æ–ø–∏—é –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã[m
[32m+[m[32m    df_processed = df.copy()[m
[32m+[m[41m    [m
[32m+[m[32m    # –°–æ–∑–¥–∞–µ–º –∫–æ–ª–æ–Ω–∫—É —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–∂–∞—Ä–æ–≤ (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ = 1 –ø–æ–∂–∞—Ä)[m
[32m+[m[32m    df_processed['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] = 1[m
[32m+[m[41m    [m
[32m+[m[32m    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã[m
[32m+[m[32m    date_columns = ['–¥–∞—Ç–∞ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è', '–¥–∞—Ç–∞'][m
[32m+[m[32m    date_column = None[m
[32m+[m[32m    for col in date_columns:[m
[32m+[m[32m        if col in df_processed.columns:[m
[32m+[m[32m            date_column = col[m
[32m+[m[32m            break[m
[32m+[m[41m    [m
[32m+[m[32m    if date_column:[m
[32m+[m[32m        df_processed['–¥–∞—Ç–∞'] = pd.to_datetime(df_processed[date_column], errors='coerce')[m
[32m+[m[32m        df_processed['–≥–æ–¥'] = df_processed['–¥–∞—Ç–∞'].dt.year[m
[32m+[m[32m        df_processed['–º–µ—Å—è—Ü'] = df_processed['–¥–∞—Ç–∞'].dt.month[m
[32m+[m[32m        df_processed['–º–µ—Å—è—Ü_–Ω–∞–∑–≤–∞–Ω–∏–µ'] = df_processed['–¥–∞—Ç–∞'].dt.month_name()[m
[32m+[m[32m    else:[m
[32m+[m[32m        # –ï—Å–ª–∏ –¥–∞—Ç—ã –Ω–µ—Ç, —Å–æ–∑–¥–∞–µ–º —Ñ–∏–∫—Ç–∏–≤–Ω—ã–µ –≥–æ–¥ –∏ –º–µ—Å—è—Ü[m
[32m+[m[32m        df_processed['–≥–æ–¥'] = 2023[m
[32m+[m[32m        df_processed['–º–µ—Å—è—Ü'] = 1[m
[32m+[m[32m        df_processed['–º–µ—Å—è—Ü_–Ω–∞–∑–≤–∞–Ω–∏–µ'] = '–Ø–Ω–≤–∞—Ä—å'[m
[32m+[m[41m    [m
[32m+[m[32m    # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å[m
[32m+[m[32m    column_mapping = {[m
[32m+[m[32m        '–º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã–π —Ä–∞–π–æ–Ω': '—Ä–∞–π–æ–Ω',[m
[32m+[m[32m        '–Ω–∞—Å–µ–ª–µ–Ω–Ω—ã–π –ø—É–Ω–∫—Ç': '–Ω–∞—Å–µ–ª–µ–Ω–Ω—ã–π_–ø—É–Ω–∫—Ç',[m[41m [m
[32m+[m[32m        '—É–ª–∏—Ü–∞': '—É–ª–∏—Ü–∞',[m
[32m+[m[32m        '–¥–æ–º': '–¥–æ–º',[m
[32m+[m[32m        '–≥–µ–æ—Ç–æ—á–∫–∞': '–≥–µ–æ—Ç–æ—á–∫–∞',[m
[32m+[m[32m        '–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å': '–∞–¥—Ä–µ—Å',[m
[32m+[m[32m        '–æ–±—ä–µ–∫—Ç –ø–æ–∂–∞—Ä–∞ (–∑–∞–≥–æ—Ä–∞–Ω–∏—è)': '–æ–±—ä–µ–∫—Ç',[m
[32m+[m[32m        '–æ–±—ä–µ–∫—Ç –ø–æ–∂–∞—Ä–∞': '–æ–±—ä–µ–∫—Ç',[m
[32m+[m[32m        '–ø—Ä–∏—á–∏–Ω–∞ –ø–æ–∂–∞—Ä–∞': '–ø—Ä–∏—á–∏–Ω–∞',[m
[32m+[m[32m        '–ø–æ–≥–∏–±–ª–æ –ª—é–¥–µ–π: –≤—Å–µ–≥–æ': '–ø–æ–≥–∏–±–ª–æ',[m
[32m+[m[32m        '–≤  —Ç.—á. –ø–æ–≥–∏–±–ª–æ –¥–µ—Ç–µ–π': '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π',[m[41m [m
[32m+[m[32m        '–ø–æ–ª—É—á–∏–ª–∏ —Ç—Ä–∞–≤–º—ã: –≤—Å–µ–≥–æ': '—Ç—Ä–∞–≤–º—ã',[m
[32m+[m[32m        '–≤  —Ç.—á. –ø–æ–ª—É—á–∏–ª–∏ —Ç—Ä–∞–≤–º—ã: –¥–µ—Ç–µ–π': '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π',[m
[32m+[m[32m        '—Å–ø–∞—Å–µ–Ω–æ –Ω–∞ –ø–æ–∂–∞—Ä–µ –ª—é–¥–µ–π': '—Å–ø–∞—Å–µ–Ω–æ',[m
[32m+[m[32m        '—ç–≤–∞–∫—É–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –ø–æ–∂–∞—Ä–µ –ª—é–¥–µ–π': '—ç–≤–∞–∫—É–∏—Ä–æ–≤–∞–Ω–æ'[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    for old_col, new_col in column_mapping.items():[m
[32m+[m[32m        if old_col in df_processed.columns and new_col not in df_processed.columns:[m
[32m+[m[32m            df_processed[new_col] = df_processed[old_col][m
[32m+[m[41m    [m
[32m+[m[32m    # –£–õ–£–ß–®–ï–ù–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –ß–ò–°–õ–û–í–´–• –î–ê–ù–ù–´–•[m
[32m+[m[32m    df_processed = process_numeric_data(df_processed)[m
[32m+[m[41m    [m
[32m+[m[32m    # –û–ë–†–ê–ë–û–¢–ö–ê –ì–ï–û–î–ê–ù–ù–´–•[m
[32m+[m[32m    df_processed = process_geodata(df_processed)[m
[32m+[m[41m    [m
[32m+[m[32m    # –£–õ–£–ß–®–ï–ù–ù–ê–Ø –û–ë–†–ê–ë–û–¢–ö–ê –ü–†–ò–ß–ò–ù[m
[32m+[m[32m    df_processed = improve_cause_analysis(df_processed)[m
[32m+[m[41m    [m
[32m+[m[32m    # –ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö[m
[32m+[m[32m    text_columns = ['—Ä–∞–π–æ–Ω', '–æ–±—ä–µ–∫—Ç', '–ø—Ä–∏—á–∏–Ω–∞', '–Ω–∞—Å–µ–ª–µ–Ω–Ω—ã–π_–ø—É–Ω–∫—Ç'][m
[32m+[m[32m    for col in text_columns:[m
[32m+[m[32m        if col in df_processed.columns:[m
[32m+[m[32m            df_processed[col] = df_processed[col].fillna('–ù–µ —É–∫–∞–∑–∞–Ω–æ')[m
[32m+[m[32m        else:[m
[32m+[m[32m            df_processed[col] = '–ù–µ —É–∫–∞–∑–∞–Ω–æ'[m
[32m+[m[41m    [m
[32m+[m[32m    return df_processed[m
[32m+[m
[32m+[m[32mdef process_numeric_data(df):[m
[32m+[m[32m    """–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ–º –≤–∑—Ä–æ—Å–ª—ã—Ö –∏ –¥–µ—Ç–µ–π"""[m
[32m+[m[32m    # –°–ø–∏—Å–æ–∫ —á–∏—Å–ª–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏[m
[32m+[m[32m    numeric_columns = [[m
[32m+[m[32m        '–ø–æ–≥–∏–±–ª–æ', '—Ç—Ä–∞–≤–º—ã', '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π', '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π',[m[41m [m
[32m+[m[32m        '—Å–ø–∞—Å–µ–Ω–æ', '—ç–≤–∞–∫—É–∏—Ä–æ–≤–∞–Ω–æ'[m
[32m+[m[32m    ][m
[32m+[m[41m    [m
[32m+[m[32m    st.sidebar.write("**–û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∏—Å–ª–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö:**")[m
[32m+[m[41m    [m
[32m+[m[32m    for col in numeric_columns:[m
[32m+[m[32m        if col in df.columns:[m
[32m+[m[32m            # –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ[m
[32m+[m[32m            df[col] = df[col].replace(['', ' ', '  ', None, 'None', 'NaN', 'nan'], 0)[m
[32m+[m[32m            df[col] = df[col].astype(str).str.replace(',', '.')[m
[32m+[m[32m            df[col] = df[col].astype(str).str.strip()[m
[32m+[m[32m            df[col] = pd.to_numeric(df[col], errors='coerce')[m
[32m+[m[32m            df[col] = df[col].fillna(0)[m
[32m+[m[32m            df[col] = df[col].astype(int)[m
[32m+[m[41m            [m
[32m+[m[32m            non_zero = (df[col] > 0).sum()[m
[32m+[m[32m            st.sidebar.write(f"{col} > 0: {non_zero} –∑–∞–ø–∏—Å–µ–π")[m
[32m+[m[32m        else:[m
[32m+[m[32m            df[col] = 0[m
[32m+[m[32m            st.sidebar.write(f"{col}: –∫–æ–ª–æ–Ω–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞")[m
[32m+[m[41m    [m
[32m+[m[32m    # –û–ë–™–ï–î–ò–ù–Ø–ï–ú –î–ê–ù–ù–´–ï –û –í–ó–†–û–°–õ–´–• –ò –î–ï–¢–Ø–•[m
[32m+[m[32m    df['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'] = df['–ø–æ–≥–∏–±–ª–æ'] + df['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π'][m
[32m+[m[32m    df['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã'] = df['—Ç—Ä–∞–≤–º—ã'] + df['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π'][m
[32m+[m[41m    [m
[32m+[m[32m    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É[m
[32m+[m[32m    total_deaths = df['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'].sum()[m
[32m+[m[32m    total_injuries = df['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã'].sum()[m
[32m+[m[32m    child_deaths = df['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π'].sum()[m
[32m+[m[32m    child_injuries = df['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π'].sum()[m
[32m+[m[41m    [m
[32m+[m[32m    st.sidebar.success(f"–ò—Ç–æ–≥–æ - –ü–æ–≥–∏–±—à–∏—Ö: {total_deaths} (–¥–µ—Ç–µ–π: {child_deaths})")[m
[32m+[m[32m    st.sidebar.success(f"–ò—Ç–æ–≥–æ - –ü–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö: {total_injuries} (–¥–µ—Ç–µ–π: {child_injuries})")[m
[32m+[m[41m    [m
[32m+[m[32m    return df[m
[32m+[m
[32m+[m[32mdef process_geodata(df):[m
[32m+[m[32m    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç"""[m
[32m+[m[32m    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –≥–µ–æ—Ç–æ—á–µ–∫[m
[32m+[m[32m    if '–≥–µ–æ—Ç–æ—á–∫–∞' in df.columns:[m
[32m+[m[32m        try:[m
[32m+[m[32m            # –†–∞–∑–¥–µ–ª—è–µ–º –≥–µ–æ—Ç–æ—á–∫—É –Ω–∞ –¥–≤–∞ —á–∏—Å–ª–∞[m
[32m+[m[32m            coords = df['–≥–µ–æ—Ç–æ—á–∫–∞'].astype(str).str.split(' ', expand=True)[m
[32m+[m[41m            [m
[32m+[m[32m            if len(coords.columns) >= 2:[m
[32m+[m[32m                # –ü–æ–ª—É—á–∞–µ–º –æ–±–∞ —á–∏—Å–ª–∞[m
[32m+[m[32m                num1 = pd.to_numeric(coords[0], errors='coerce')[m
[32m+[m[32m                num2 = pd.to_numeric(coords[1], errors='coerce')[m
[32m+[m[41m                [m
[32m+[m[32m                # –°–æ–∑–¥–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç[m
[32m+[m[32m                df['lat'] = None[m
[32m+[m[32m                df['lon'] = None[m
[32m+[m[41m                [m
[32m+[m[32m                valid_count = 0[m
[32m+[m[32m                invalid_count = 0[m
[32m+[m[41m                [m
[32m+[m[32m                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –æ—Ç–¥–µ–ª—å–Ω–æ[m
[32m+[m[32m                for idx in df.index:[m
[32m+[m[32m                    if pd.isna(num1[idx]) or pd.isna(num2[idx]):[m
[32m+[m[32m                        invalid_count += 1[m
[32m+[m[32m                        continue[m
[32m+[m[41m                    [m
[32m+[m[32m                    # –ü—Ä–æ–±—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç 1: num1 = —à–∏—Ä–æ—Ç–∞, num2 = –¥–æ–ª–≥–æ—Ç–∞[m
[32m+[m[32m                    if (-90 <= num1[idx] <= 90) and (-180 <= num2[idx] <= 180):[m
[32m+[m[32m                        df.at[idx, 'lat'] = num1[idx]  # —à–∏—Ä–æ—Ç–∞[m
[32m+[m[32m                        df.at[idx, 'lon'] = num2[idx]  # –¥–æ–ª–≥–æ—Ç–∞[m
[32m+[m[32m                        valid_count += 1[m
[32m+[m[41m                    [m
[32m+[m[32m                    # –ü—Ä–æ–±—É–µ–º –≤–∞—Ä–∏–∞–Ω—Ç 2: num1 = –¥–æ–ª–≥–æ—Ç–∞, num2 = —à–∏—Ä–æ—Ç–∞[m[41m  [m
[32m+[m[32m                    elif (-90 <= num2[idx] <= 90) and (-180 <= num1[idx] <= 180):[m
[32m+[m[32m                        df.at[idx, 'lat'] = num2[idx]  # —à–∏—Ä–æ—Ç–∞[m
[32m+[m[32m                        df.at[idx, 'lon'] = num1[idx]  # –¥–æ–ª–≥–æ—Ç–∞[m
[32m+[m[32m                        valid_count += 1[m
[32m+[m[41m                    [m
[32m+[m[32m                    else:[m
[32m+[m[32m                        invalid_count += 1[m
[32m+[m[41m                [m
[32m+[m[32m                # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç[m
[32m+[m[32m                df['lat'] = pd.to_numeric(df['lat'], errors='coerce')[m
[32m+[m[32m                df['lon'] = pd.to_numeric(df['lon'], errors='coerce')[m
[32m+[m[41m                [m
[32m+[m[32m                # –£–±–∏—Ä–∞–µ–º —Å—Ç—Ä–æ–∫–∏ —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏[m
[32m+[m[32m                valid_coords = df.dropna(subset=['lat', 'lon'])[m
[32m+[m[41m                [m
[32m+[m[32m                st.sidebar.success(f"–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –≥–µ–æ—Ç–æ—á–µ–∫: {valid_count}/{len(df)}")[m
[32m+[m[41m                [m
[32m+[m[32m                if invalid_count > 0:[m
[32m+[m[32m                    st.sidebar.warning(f"–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã: {invalid_count} –∑–∞–ø–∏—Å–µ–π")[m
[32m+[m[41m                [m
[32m+[m[32m                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–º–µ—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç[m
[32m+[m[32m                if not valid_coords.empty:[m
[32m+[m[32m                    with st.sidebar.expander("üìç –ü—Ä–∏–º–µ—Ä—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç"):[m
[32m+[m[32m                        sample = valid_coords[['–≥–µ–æ—Ç–æ—á–∫–∞', 'lat', 'lon']].head(3)[m
[32m+[m[32m                        for _, row in sample.iterrows():[m
[32m+[m[32m                            st.write(f"{row['–≥–µ–æ—Ç–æ—á–∫–∞']} ‚Üí lat:{row['lat']:.6f}, lon:{row['lon']:.6f}")[m
[32m+[m[41m                [m
[32m+[m[32m        except Exception as e:[m
[32m+[m[32m            st.sidebar.error(f"–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö: {e}")[m
[32m+[m[41m    [m
[32m+[m[32m    return df[m
[32m+[m
[32m+[m[32mdef improve_cause_analysis(df):[m
[32m+[m[32m    """–£–ª—É—á—à–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –ø–æ–∂–∞—Ä–æ–≤"""[m
[32m+[m[32m    # –ò—â–µ–º –∫–æ–ª–æ–Ω–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–∏—á–∏–Ω–∞—Ö[m
[32m+[m[32m    cause_columns = [][m
[32m+[m[32m    for col in df.columns:[m
[32m+[m[32m        if any(keyword in col.lower() for keyword in ['–ø—Ä–∏—á–∏–Ω–∞', 'cause', 'reason']):[m
[32m+[m[32m            cause_columns.append(col)[m
[32m+[m[41m    [m
[32m+[m[32m    # –ï—Å–ª–∏ –Ω–∞—à–ª–∏ –∫–æ–ª–æ–Ω–∫–∏ —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏, –æ–±—ä–µ–¥–∏–Ω—è–µ–º –∏—Ö[m
[32m+[m[32m    if cause_columns:[m
[32m+[m[32m        st.sidebar.info(f"–ù–∞–π–¥–µ–Ω—ã –∫–æ–ª–æ–Ω–∫–∏ —Å –ø—Ä–∏—á–∏–Ω–∞–º–∏: {cause_columns}")[m
[32m+[m[41m        [m
[32m+[m[32m        # –°–æ–∑–¥–∞–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—É—é –∫–æ–ª–æ–Ω–∫—É –ø—Ä–∏—á–∏–Ω[m
[32m+[m[32m        causes_combined = [][m
[32m+[m[32m        for idx, row in df.iterrows():[m
[32m+[m[32m            causes = [][m
[32m+[m[32m            for col in cause_columns:[m
[32m+[m[32m                if pd.notna(row[col]) and str(row[col]).strip() not in ['', 'nan', 'None']:[m
[32m+[m[32m                    causes.append(str(row[col]).strip())[m
[32m+[m[41m            [m
[32m+[m[32m            if causes:[m
[32m+[m[32m                causes_combined.append('; '.join(causes))[m
[32m+[m[32m            else:[m
[32m+[m[32m                causes_combined.append('–ù–µ —É–∫–∞–∑–∞–Ω–∞')[m
[32m+[m[41m        [m
[32m+[m[32m        df['–ø—Ä–∏—á–∏–Ω–∞_–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è'] = causes_combined[m
[32m+[m[32m    else:[m
[32m+[m[32m        # –ï—Å–ª–∏ –Ω–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫, –∏—â–µ–º –≤ –¥—Ä—É–≥–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö[m
[32m+[m[32m        df['–ø—Ä–∏—á–∏–Ω–∞_–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è'] = '–ù–µ —É–∫–∞–∑–∞–Ω–∞'[m
[32m+[m[41m    [m
[32m+[m[32m    # –û—á–∏—Å—Ç–∫–∞ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏—á–∏–Ω[m
[32m+[m[32m    df['–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è'] = df['–ø—Ä–∏—á–∏–Ω–∞_–æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–∞—è'].apply(clean_and_categorize_cause)[m
[32m+[m[41m    [m
[32m+[m[32m    return df[m
[32m+[m
[32m+[m[32mdef clean_and_categorize_cause(cause_text):[m
[32m+[m[32m    """–û—á–∏—Å—Ç–∫–∞ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏—á–∏–Ω –ø–æ–∂–∞—Ä–æ–≤"""[m
[32m+[m[32m    if pd.isna(cause_text) or cause_text in ['', 'nan', 'None', '–ù–µ —É–∫–∞–∑–∞–Ω–∞']:[m
[32m+[m[32m        return '–ü—Ä–∏—á–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞'[m
[32m+[m[41m    [m
[32m+[m[32m    text = str(cause_text).lower().strip()[m
[32m+[m[41m    [m
[32m+[m[32m    # –ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏—á–∏–Ω[m
[32m+[m[32m    cause_patterns = {[m
[32m+[m[32m        '–≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': [[m
[32m+[m[32m            '—ç–ª–µ–∫—Ç—Ä', '–ø—Ä–æ–≤–æ–¥–∫–∞', '–∫–æ—Ä–æ—Ç–∫–æ–µ –∑–∞–º—ã–∫–∞–Ω–∏–µ', '—ç–ª–µ–∫—Ç—Ä–∏—á', '—Ä–æ–∑–µ—Ç–∫–∞',[m[41m [m
[32m+[m[32m            '–≤—ã–∫–ª—é—á–∞—Ç–µ–ª—å', '—Å–µ—Ç—å', '–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ', '—ç–ª.', '—ç–ª.–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ'[m
[32m+[m[32m        ],[m
[32m+[m[32m        '–ù–µ–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ —Å –æ–≥–Ω–µ–º': [[m
[32m+[m[32m            '–Ω–µ–æ—Å—Ç–æ—Ä–æ–∂', '–∫—É—Ä–µ–Ω–∏–µ', '—Å–ø–∏—á–∫–∏', '–∑–∞–∂–∏–≥–∞–ª–∫–∞', '–æ–≥–æ–Ω—å', '–∫–æ—Å—Ç–µ—Ä',[m
[32m+[m[32m            '–ø–æ–¥–∂–æ–≥', '—É–º—ã—à–ª–µ–Ω', '–¥–µ—Ç—Å–∫–∞—è —à–∞–ª–æ—Å—Ç—å'[m
[32m+[m[32m        ],[m
[32m+[m[32m        '–ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞': [[m
[32m+[m[32m            '—Ç–µ–ª–µ–≤–∏–∑–æ—Ä', '—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫', '—á–∞–π–Ω–∏–∫', '—É—Ç—é–≥', '–º–∏–∫—Ä–æ–≤–æ–ª–Ω–æ–≤–∫–∞',[m
[32m+[m[32m            '–æ–±–æ–≥—Ä–µ–≤–∞—Ç–µ–ª—å', '–æ—Ç–æ–ø–ª–µ–Ω–∏–µ', '–ø–µ—á—å', '–∫–∞–º–∏–Ω'[m
[32m+[m[32m        ],[m
[32m+[m[32m        '–ü—Ä–∏—Ä–æ–¥–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã': [[m
[32m+[m[32m            '–º–æ–ª–Ω–∏—è', '–≥—Ä–æ–∑–∞', '—Å–æ–ª–Ω—Ü–µ', '–∑–∞—Å—É—Ö–∞', '–ø—Ä–∏—Ä–æ–¥–Ω', '—Å–∞–º–æ–≤–æ–∑–≥–æ—Ä–∞–Ω–∏–µ'[m
[32m+[m[32m        ],[m
[32m+[m[32m        '–¢–µ—Ö–Ω–æ–≥–µ–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã': [[m
[32m+[m[32m            '–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤', '—Ç–µ—Ö–Ω–∏–∫', '–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', '–∞–≤—Ç–æ–º–æ–±–∏–ª—å', '—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',[m
[32m+[m[32m            '–≥–∞–∑', '—Ç–æ–ø–ª–∏–≤–æ', '—Ö–∏–º–∏—á', '–≥–æ—Ä—é—á'[m
[32m+[m[32m        ],[m
[32m+[m[32m        '–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã': [[m
[32m+[m[32m            '—Ä–µ–º–æ–Ω—Ç', '—Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤', '—Å–≤–∞—Ä–∫–∞', '–æ—Ç–¥–µ–ª–∫', '–ø–æ–∫—Ä–∞—Å–∫–∞'[m
[32m+[m[32m        ],[m
[32m+[m[32m        '–ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –ø–æ–∂–∞—Ä–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏': [[m
[32m+[m[32m            '–Ω–∞—Ä—É—à–µ–Ω–∏–µ', '–ø—Ä–∞–≤–∏–ª–∞', '–ø–æ–∂–∞—Ä–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', '–ø–ø–±', '–Ω–æ—Ä–º—ã'[m
[32m+[m[32m        ][m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏[m
[32m+[m[32m    for category, patterns in cause_patterns.items():[m
[32m+[m[32m        for pattern in patterns:[m
[32m+[m[32m            if pattern in text:[m
[32m+[m[32m                return category[m
[32m+[m[41m    [m
[32m+[m[32m    # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é, –Ω–æ —Ç–µ–∫—Å—Ç –Ω–µ –ø—É—Å—Ç–æ–π[m
[32m+[m[32m    if len(text) > 10 and text not in ['–Ω–µ —É–∫–∞–∑–∞–Ω–∞', '–Ω–µ—Ç', '–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞']:[m
[32m+[m[32m        return '–î—Ä—É–≥–∏–µ –ø—Ä–∏—á–∏–Ω—ã'[m
[32m+[m[41m    [m
[32m+[m[32m    return '–ü—Ä–∏—á–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞'[m
[32m+[m
[32m+[m[32m# –§–£–ù–ö–¶–ò–ò –ê–ù–ê–õ–ò–ó–ê - –û–ü–†–ï–î–ï–õ–ï–ù–´ –ü–ï–†–ï–î –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï–ú[m
[32m+[m[32mdef analyze_fire_trends(df):[m
[32m+[m[32m    """–ê–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏ –ø–æ–∂–∞—Ä–æ–≤ –ø–æ –≥–æ–¥–∞–º"""[m
[32m+[m[32m    st.subheader("1. –î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∂–∞—Ä–æ–≤ –ø–æ –≥–æ–¥–∞–º")[m
[32m+[m[41m    [m
[32m+[m[32m    if '–≥–æ–¥' in df.columns:[m
[32m+[m[32m        # –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏[m
[32m+[m[32m        yearly_data = df.groupby('–≥–æ–¥').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m            '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m            '–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã': 'sum',[m
[32m+[m[32m            '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π': 'sum',[m
[32m+[m[32m            '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π': 'sum'[m
[32m+[m[32m        }).reset_index()[m
[32m+[m[41m        [m
[32m+[m[32m        if not yearly_data.empty:[m
[32m+[m[32m            col1, col2 = st.columns(2)[m
[32m+[m[41m            [m
[32m+[m[32m            with col1:[m
[32m+[m[32m                create_chart(yearly_data, 'line', x='–≥–æ–¥', y='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤',[m[41m [m
[32m+[m[32m                            title='–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∂–∞—Ä–æ–≤ –ø–æ –≥–æ–¥–∞–º')[m
[32m+[m[41m            [m
[32m+[m[32m            with col2:[m
[32m+[m[32m                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ—Ç—Ä–∏–∫–∏[m
[32m+[m[32m                if len(yearly_data) > 1:[m
[32m+[m[32m                    last_year = yearly_data.iloc[-1][m
[32m+[m[32m                    prev_year = yearly_data.iloc[-2][m
[32m+[m[41m                    [m
[32m+[m[32m                    col1, col2, col3, col4 = st.columns(4)[m
[32m+[m[41m                    [m
[32m+[m[32m                    with col1:[m
[32m+[m[32m                        delta_fires = last_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] - prev_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'][m
[32m+[m[32m                        st.metric("–ü–æ–∂–∞—Ä—ã", f"{last_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤']:.0f}",[m[41m [m
[32m+[m[32m                                 f"{delta_fires:+.0f}")[m
[32m+[m[41m                    [m
[32m+[m[32m                    with col2:[m
[32m+[m[32m                        delta_deaths = last_year['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'] - prev_year['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'][m
[32m+[m[32m                        st.metric("–í—Å–µ–≥–æ –ø–æ–≥–∏–±—à–∏—Ö", f"{last_year['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ']:.0f}",[m[41m [m
[32m+[m[32m                                 f"{delta_deaths:+.0f}")[m
[32m+[m[41m                    [m
[32m+[m[32m                    with col3:[m
[32m+[m[32m                        delta_injuries = last_year['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã'] - prev_year['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã'][m
[32m+[m[32m                        st.metric("–í—Å–µ–≥–æ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö", f"{last_year['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã']:.0f}",[m[41m [m
[32m+[m[32m                                 f"{delta_injuries:+.0f}")[m
[32m+[m[41m                    [m
[32m+[m[32m                    with col4:[m
[32m+[m[32m                        delta_children = (last_year['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π'] + last_year['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π']) - \[m
[32m+[m[32m                                       (prev_year['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π'] + prev_year['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π'])[m
[32m+[m[32m                        st.metric("–ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ –¥–µ—Ç–µ–π",[m[41m [m
[32m+[m[32m                                 f"{(last_year['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π'] + last_year['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π']):.0f}",[m[41m [m
[32m+[m[32m                                 f"{delta_children:+.0f}")[m
[32m+[m[41m                [m
[32m+[m[32m                # –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∂–µ—Ä—Ç–≤–∞–º[m
[32m+[m[32m                with st.expander("üìä –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–≥–∏–±—à–∏–º –∏ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏–º"):[m
[32m+[m[32m                    if len(yearly_data) > 0:[m
[32m+[m[32m                        current_year = yearly_data.iloc[-1][m
[32m+[m[32m                        st.write(f"**–ó–∞ {current_year['–≥–æ–¥']} –≥–æ–¥:**")[m
[32m+[m[32m                        col1, col2, col3, col4 = st.columns(4)[m
[32m+[m[32m                        col1.metric("–í—Å–µ–≥–æ –ø–æ–≥–∏–±—à–∏—Ö", f"{current_year['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ']:.0f}")[m
[32m+[m[32m                        col2.metric("–≤ —Ç.—á. –¥–µ—Ç–µ–π", f"{current_year['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π']:.0f}")[m
[32m+[m[32m                        col3.metric("–í—Å–µ–≥–æ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö", f"{current_year['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã']:.0f}")[m
[32m+[m[32m                        col4.metric("–≤ —Ç.—á. –¥–µ—Ç–µ–π", f"{current_year['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π']:.0f}")[m
[32m+[m[41m            [m
[32m+[m[32m            # –ì—Ä–∞—Ñ–∏–∫ –ø–æ–≥–∏–±—à–∏—Ö –∏ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö[m
[32m+[m[32m            if yearly_data['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'].sum() > 0 or yearly_data['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã'].sum() > 0:[m
[32m+[m[32m                fig = px.line(yearly_data, x='–≥–æ–¥', y=['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ', '–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã'],[m
[32m+[m[32m                            title='–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–≥–∏–±—à–∏—Ö –∏ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö',[m
[32m+[m[32m                            labels={'value': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π', 'variable': '–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å'})[m
[32m+[m[32m                fig.update_traces(line=dict(width=3))[m
[32m+[m[32m                st.plotly_chart(fig, use_container_width=True)[m
[32m+[m[41m                [m
[32m+[m[32m        else:[m
[32m+[m[32m            st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏")[m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ —Å –≥–æ–¥–æ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏")[m
[32m+[m
[32m+[m[32mdef analyze_district_map(df):[m
[32m+[m[32m    """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–æ–∂–∞—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–µ–∞–ª—å–Ω—ã—Ö –≥–µ–æ—Ç–æ—á–µ–∫"""[m
[32m+[m[32m    st.subheader("2.2 –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∂–∞—Ä–æ–≤ –ø–æ —Ä–∞–π–æ–Ω–∞–º –Ω–∞ –∫–∞—Ä—Ç–µ")[m
[32m+[m[41m    [m
[32m+[m[32m    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç[m
[32m+[m[32m    if 'lat' in df.columns and 'lon' in df.columns:[m
[32m+[m[32m        # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã[m
[32m+[m[32m        map_data = df.dropna(subset=['lat', 'lon']).copy()[m
[32m+[m[41m        [m
[32m+[m[32m        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç[m
[32m+[m[32m        map_data = map_data[[m
[32m+[m[32m            (map_data['lat'] >= -90) & (map_data['lat'] <= 90) &[m
[32m+[m[32m            (map_data['lon'] >= -180) & (map_data['lon'] <= 180)[m
[32m+[m[32m        ][m
[32m+[m[41m        [m
[32m+[m[32m        if map_data.empty:[m
[32m+[m[32m            st.warning("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–∞—Ä—Ç—ã")[m
[32m+[m[32m            return[m
[32m+[m[41m        [m
[32m+[m[32m        st.info(f"–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è {len(map_data)} —Ç–æ—á–µ–∫ –∏–∑ {len(df)} –∑–∞–ø–∏—Å–µ–π")[m
[32m+[m[41m        [m
[32m+[m[32m        # –ê–≥—Ä–µ–≥–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞—Ä—Ç—ã (–≥—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º)[m
[32m+[m[32m        if '—Ä–∞–π–æ–Ω' in df.columns:[m
[32m+[m[32m            aggregated_data = map_data.groupby(['—Ä–∞–π–æ–Ω', 'lat', 'lon']).agg({[m
[32m+[m[32m                '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m                '–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m                '—Ç—Ä–∞–≤–º—ã': 'sum',[m
[32m+[m[32m                '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π': 'sum',[m
[32m+[m[32m                '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π': 'sum'[m
[32m+[m[32m            }).reset_index()[m
[32m+[m[32m        else:[m
[32m+[m[32m            aggregated_data = map_data.groupby(['lat', 'lon']).agg({[m
[32m+[m[32m                '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m                '–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m                '—Ç—Ä–∞–≤–º—ã': 'sum',[m
[32m+[m[32m                '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π': 'sum',[m
[32m+[m[32m                '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π': 'sum'[m
[32m+[m[32m            }).reset_index()[m
[32m+[m[32m            aggregated_data['—Ä–∞–π–æ–Ω'] = '–ù–µ —É–∫–∞–∑–∞–Ω'[m
[32m+[m[41m        [m
[32m+[m[32m        if PLOTLY_AVAILABLE:[m
[32m+[m[32m            try:[m
[32m+[m[32m                # –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç—É[m
[32m+[m[32m                fig = px.scatter_mapbox([m
[32m+[m[32m                    aggregated_data,[m
[32m+[m[32m                    lat="lat",[m
[32m+[m[32m                    lon="lon",[m[41m [m
[32m+[m[32m                    size="–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤",[m
[32m+[m[32m                    color="–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤",[m
[32m+[m[32m                    hover_name="—Ä–∞–π–æ–Ω",[m
[32m+[m[32m                    hover_data={[m
[32m+[m[32m                        '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': True,[m
[32m+[m[32m                        '–ø–æ–≥–∏–±–ª–æ': True,[m
[32m+[m[32m                        '—Ç—Ä–∞–≤–º—ã': True,[m
[32m+[m[32m                        '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π': True,[m
[32m+[m[32m                        '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π': True,[m
[32m+[m[32m                        'lat': False,[m
[32m+[m[32m                        'lon': False[m
[32m+[m[32m                    },[m
[32m+[m[32m                    color_continuous_scale=px.colors.sequential.Reds,[m
[32m+[m[32m                    size_max=20,[m
[32m+[m[32m                    zoom=4,[m
[32m+[m[32m                    title="–ö–∞—Ä—Ç–∞ –ø–æ–∂–∞—Ä–æ–≤ –ø–æ –≥–µ–æ—Ç–æ—á–∫–∞–º"[m
[32m+[m[32m                )[m
[32m+[m[32m                fig.update_layout(mapbox_style="open-street-map")[m
[32m+[m[32m                fig.update_layout(margin={"r":0,"t":30,"l":0,"b":0})[m
[32m+[m[32m                fig.update_layout(height=600)[m
[32m+[m[32m                st.plotly_chart(fig, use_container_width=True)[m
[32m+[m[41m                [m
[32m+[m[32m                # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞—Ä—Ç–µ[m
[32m+[m[32m                col1, col2, col3, col4 = st.columns(4)[m
[32m+[m[32m                with col1:[m
[32m+[m[32m                    st.metric("–¢–æ—á–µ–∫ –Ω–∞ –∫–∞—Ä—Ç–µ", len(aggregated_data))[m
[32m+[m[32m                with col2:[m
[32m+[m[32m                    st.metric("–í—Å–µ–≥–æ –ø–æ–∂–∞—Ä–æ–≤", aggregated_data['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'].sum())[m
[32m+[m[32m                with col3:[m
[32m+[m[32m                    st.metric("–ü–æ–≥–∏–±–ª–æ –Ω–∞ –∫–∞—Ä—Ç–µ", aggregated_data['–ø–æ–≥–∏–±–ª–æ'].sum())[m
[32m+[m[32m                with col4:[m
[32m+[m[32m                    st.metric("–ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ –Ω–∞ –∫–∞—Ä—Ç–µ", aggregated_data['—Ç—Ä–∞–≤–º—ã'].sum())[m
[32m+[m[41m                [m
[32m+[m[32m            except Exception as e:[m
[32m+[m[32m                st.error(f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç—É: {e}")[m
[32m+[m[32m        else:[m
[32m+[m[32m            st.info("–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ plotly: pip install plotly")[m
[32m+[m[41m        [m
[32m+[m[32m        # –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö[m
[32m+[m[32m        with st.expander("üìã –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö"):[m
[32m+[m[32m            st.write("**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:**")[m
[32m+[m[32m            col1, col2 = st.columns(2)[m
[32m+[m[32m            with col1:[m
[32m+[m[32m                st.write(f"–®–∏—Ä–æ—Ç–∞: {map_data['lat'].min():.4f} - {map_data['lat'].max():.4f}")[m
[32m+[m[32m                st.write(f"–°—Ä–µ–¥–Ω—è—è —à–∏—Ä–æ—Ç–∞: {map_data['lat'].mean():.4f}")[m
[32m+[m[32m            with col2:[m
[32m+[m[32m                st.write(f"–î–æ–ª–≥–æ—Ç–∞: {map_data['lon'].min():.4f} - {map_data['lon'].max():.4f}")[m
[32m+[m[32m                st.write(f"–°—Ä–µ–¥–Ω—è—è –¥–æ–ª–≥–æ—Ç–∞: {map_data['lon'].mean():.4f}")[m
[32m+[m[41m            [m
[32m+[m[32m            st.write("**–ü—Ä–∏–º–µ—Ä –≥–µ–æ–¥–∞–Ω–Ω—ã—Ö:**")[m
[32m+[m[32m            display_cols = ['—Ä–∞–π–æ–Ω', '–Ω–∞—Å–µ–ª–µ–Ω–Ω—ã–π_–ø—É–Ω–∫—Ç', 'lat', 'lon', '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤', '–ø–æ–≥–∏–±–ª–æ', '—Ç—Ä–∞–≤–º—ã'][m
[32m+[m[32m            display_cols = [col for col in display_cols if col in map_data.columns][m
[32m+[m[32m            st.dataframe(map_data[display_cols].head(10), use_container_width=True)[m
[32m+[m[41m            [m
[32m+[m[32m    else:[m
[32m+[m[32m        st.warning("""[m
[32m+[m[32m        **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã!**[m
[32m+[m[41m        [m
[32m+[m[32m        –î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –∫–∞—Ä—Ç—ã –Ω—É–∂–Ω–∞ –∫–æ–ª–æ–Ω–∫–∞ '–≥–µ–æ—Ç–æ—á–∫–∞' —Å –¥–∞–Ω–Ω—ã–º–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–¥–æ–ª–≥–æ—Ç–∞ —à–∏—Ä–æ—Ç–∞"[m
[32m+[m[32m        –ü—Ä–∏–º–µ—Ä: 131.090314 60.465566[m
[32m+[m[32m        """)[m
[32m+[m
[32m+[m
[32m+[m[32mdef analyze_district_distribution(df):[m
[32m+[m[32m    """–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–∂–∞—Ä–æ–≤ –ø–æ —Ä–∞–π–æ–Ω–∞–º"""[m
[32m+[m[32m    st.subheader("2.1 –†–µ–π—Ç–∏–Ω–≥ —Ä–∞–π–æ–Ω–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∂–∞—Ä–æ–≤")[m
[32m+[m[41m    [m
[32m+[m[32m    if '—Ä–∞–π–æ–Ω' in df.columns:[m
[32m+[m[32m        district_data = df.groupby('—Ä–∞–π–æ–Ω').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m            '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m            '–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã': 'sum',[m
[32m+[m[32m            '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π': 'sum',[m
[32m+[m[32m            '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π': 'sum'[m
[32m+[m[32m        }).reset_index()[m
[32m+[m[41m        [m
[32m+[m[32m        district_data = district_data.sort_values('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤', ascending=False)[m
[32m+[m[41m        [m
[32m+[m[32m        col1, col2 = st.columns(2)[m
[32m+[m[41m        [m
[32m+[m[32m        with col1:[m
[32m+[m[32m            if not district_data.empty:[m
[32m+[m[32m                create_chart(district_data.head(10), 'bar', x='—Ä–∞–π–æ–Ω', y='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤',[m
[32m+[m[32m                            title='–¢–æ–ø-10 —Ä–∞–π–æ–Ω–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–∂–∞—Ä–æ–≤')[m
[32m+[m[32m            else:[m
[32m+[m[32m                st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞")[m
[32m+[m[41m        [m
[32m+[m[32m        with col2:[m
[32m+[m[32m            if not district_data.empty:[m
[32m+[m[32m                st.write("**–†–µ–π—Ç–∏–Ω–≥ —Ä–∞–π–æ–Ω–æ–≤ (–ø–µ—Ä–≤—ã–µ 10):**")[m
[32m+[m[32m                display_data = district_data.head(10).copy()[m
[32m+[m[41m                [m
[32m+[m[32m                # –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è[m
[32m+[m[32m                display_data = display_data.rename(columns={[m
[32m+[m[32m                    '—Ä–∞–π–æ–Ω': '–†–∞–π–æ–Ω',[m
[32m+[m[32m                    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': '–ü–æ–∂–∞—Ä—ã',[m
[32m+[m[32m                    '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': '–ü–æ–≥–∏–±–ª–æ',[m
[32m+[m[32m                    '–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã': '–ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ'[m
[32m+[m[32m                })[m
[32m+[m[41m                [m
[32m+[m[32m                # –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ª—é –æ—Ç –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞[m
[32m+[m[32m                total_fires = display_data['–ü–æ–∂–∞—Ä—ã'].sum()[m
[32m+[m[32m                display_data['–î–æ–ª—è %'] = (display_data['–ü–æ–∂–∞—Ä—ã'] / total_fires * 100).round(1)[m
[32m+[m[41m                [m
[32m+[m[32m                st.dataframe(display_data[['–†–∞–π–æ–Ω', '–ü–æ–∂–∞—Ä—ã', '–ü–æ–≥–∏–±–ª–æ', '–ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ', '–î–æ–ª—è %']],[m[41m [m
[32m+[m[32m                           use_container_width=True)[m
[32m+[m[41m                [m
[32m+[m[32m                # –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞[m
[32m+[m[32m                col1, col2, col3 = st.columns(3)[m
[32m+[m[32m                with col1:[m
[32m+[m[32m                    st.metric("–í—Å–µ–≥–æ —Ä–∞–π–æ–Ω–æ–≤", df['—Ä–∞–π–æ–Ω'].nunique())[m
[32m+[m[32m                with col2:[m
[32m+[m[32m                    st.metric("–°—Ä–µ–¥–Ω–µ–µ –ø–æ–∂–∞—Ä–æ–≤ –Ω–∞ —Ä–∞–π–æ–Ω",[m[41m [m
[32m+[m[32m                             f"{district_data['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'].mean():.1f}")[m
[32m+[m[32m                with col3:[m
[32m+[m[32m                    st.metric("–í—Å–µ–≥–æ –ø–æ–≥–∏–±—à–∏—Ö", f"{district_data['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'].sum():.0f}")[m
[32m+[m[41m                [m
[32m+[m[32m                # –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–µ—Ç—è–º[m
[32m+[m[32m                if (district_data['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π'].sum() > 0 or[m[41m [m
[32m+[m[32m                    district_data['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π'].sum() > 0):[m
[32m+[m[32m                    with st.expander("üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–µ—Ç—è–º"):[m
[32m+[m[32m                        col1, col2 = st.columns(2)[m
[32m+[m[32m                        with col1:[m
[32m+[m[32m                            st.metric("–ü–æ–≥–∏–±–ª–æ –¥–µ—Ç–µ–π", f"{district_data['–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π'].sum():.0f}")[m
[32m+[m[32m                        with col2:[m
[32m+[m[32m                            st.metric("–ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ –¥–µ—Ç–µ–π", f"{district_data['—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π'].sum():.0f}")[m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ —Å —Ä–∞–π–æ–Ω–∞–º–∏")[m
[32m+[m
[32m+[m
[32m+[m[32mdef analyze_causes(df):[m
[32m+[m[32m    """–ê–Ω–∞–ª–∏–∑ –ø—Ä–∏—á–∏–Ω –ø–æ–∂–∞—Ä–æ–≤"""[m
[32m+[m[32m    st.subheader("3. –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –ø–æ–∂–∞—Ä–æ–≤")[m
[32m+[m[41m    [m
[32m+[m[32m    if '–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è' in df.columns:[m
[32m+[m[32m        # –ê–Ω–∞–ª–∏–∑ –æ—á–∏—â–µ–Ω–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω[m
[32m+[m[32m        causes_data = df.groupby('–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m            '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m            '–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã': 'sum',[m
[32m+[m[32m            '–ø–æ–≥–∏–±–ª–æ_–¥–µ—Ç–µ–π': 'sum',[m
[32m+[m[32m            '—Ç—Ä–∞–≤–º—ã_–¥–µ—Ç–µ–π': 'sum'[m
[32m+[m[32m        }).reset_index()[m
[32m+[m[41m        [m
[32m+[m[32m        causes_data = causes_data.sort_values('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤', ascending=False)[m
[32m+[m[41m        [m
[32m+[m[32m        if not causes_data.empty:[m
[32m+[m[32m            col1, col2 = st.columns(2)[m
[32m+[m[41m            [m
[32m+[m[32m            with col1:[m
[32m+[m[32m                plot_data = causes_data.copy()[m
[32m+[m[32m                if len(plot_data) > 1 and plot_data.iloc[0]['–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è'] == '–ü—Ä–∏—á–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞':[m
[32m+[m[32m                    if plot_data.iloc[0]['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] / plot_data['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'].sum() > 0.8:[m
[32m+[m[32m                        other_causes = plot_data[plot_data['–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è'] != '–ü—Ä–∏—á–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞'][m
[32m+[m[32m                        if not other_causes.empty:[m
[32m+[m[32m                            plot_data = other_causes.head(7)[m
[32m+[m[32m                            st.info("–ü–æ–∫–∞–∑–∞–Ω—ã –∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –ø—Ä–∏—á–∏–Ω—ã)")[m
[32m+[m[41m                [m
[32m+[m[32m                create_chart(plot_data.head(8), 'pie', names='–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è',[m[41m [m
[32m+[m[32m                            values='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤', title='–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –ø—Ä–∏—á–∏–Ω–∞–º')[m
[32m+[m[41m            [m
[32m+[m[32m            with col2:[m
[32m+[m[32m                st.write("**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–∏—á–∏–Ω–∞–º:**")[m
[32m+[m[32m                display_causes = causes_data.copy()[m
[32m+[m[32m                display_causes['–¥–æ–ª—è'] = (display_causes['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] / display_causes['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'].sum() * 100).round(1)[m
[32m+[m[32m                display_causes = display_causes.rename(columns={[m
[32m+[m[32m                    '–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è': '–ü—Ä–∏—á–∏–Ω–∞',[m
[32m+[m[32m                    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ',[m
[32m+[m[32m                    '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': '–ü–æ–≥–∏–±–ª–æ',[m
[32m+[m[32m                    '–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã': '–ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ',[m
[32m+[m[32m                    '–¥–æ–ª—è': '–î–æ–ª—è (%)'[m
[32m+[m[32m                })[m
[32m+[m[32m                st.dataframe(display_causes[['–ü—Ä–∏—á–∏–Ω–∞', '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ', '–ü–æ–≥–∏–±–ª–æ', '–ü–æ—Å—Ç—Ä–∞–¥–∞–ª–æ', '–î–æ–ª—è (%)']],[m[41m [m
[32m+[m[32m                           use_container_width=True)[m
[32m+[m[41m        [m
[32m+[m[32m        # –ê–Ω–∞–ª–∏–∑ —Å–∞–º—ã—Ö –æ–ø–∞—Å–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω[m
[32m+[m[32m        if df['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'].sum() > 0:[m
[32m+[m[32m            st.subheader("–ü—Ä–∏—á–∏–Ω—ã —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º–∏ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è–º–∏")[m
[32m+[m[41m            [m
[32m+[m[32m            dangerous_causes = df.groupby('–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è').agg({[m
[32m+[m[32m                '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m                '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m                '–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã': 'sum'[m
[32m+[m[32m            }).reset_index()[m
[32m+[m[41m            [m
[32m+[m[32m            dangerous_causes = dangerous_causes[dangerous_causes['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'] > 0][m
[32m+[m[32m            dangerous_causes['—Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å_%'] = (dangerous_causes['–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ'] / dangerous_causes['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] * 100).round(2)[m
[32m+[m[32m            dangerous_causes['—Ç—Ä–∞–≤–º–∞—Ç–∏–∑–º_%'] = (dangerous_causes['–≤—Å–µ–≥–æ_—Ç—Ä–∞–≤–º—ã'] / dangerous_causes['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] * 100).round(2)[m
[32m+[m[41m            [m
[32m+[m[32m            col1, col2 = st.columns(2)[m
[32m+[m[41m            [m
[32m+[m[32m            with col1:[m
[32m+[m[32m                st.write("**–ü–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–≥–∏–±—à–∏—Ö:**")[m
[32m+[m[32m                display_deaths = dangerous_causes.sort_values('–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ', ascending=False).head(5)[m
[32m+[m[32m                display_deaths = display_deaths.rename(columns={[m
[32m+[m[32m                    '–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è': '–ü—Ä–∏—á–∏–Ω–∞',[m
[32m+[m[32m                    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': '–ü–æ–∂–∞—Ä—ã',[m
[32m+[m[32m                    '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': '–ü–æ–≥–∏–±–ª–æ',[m
[32m+[m[32m                    '—Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å_%': '–°–º–µ—Ä—Ç–Ω–æ—Å—Ç—å %'[m
[32m+[m[32m                })[m
[32m+[m[32m                st.dataframe(display_deaths[['–ü—Ä–∏—á–∏–Ω–∞', '–ü–æ–∂–∞—Ä—ã', '–ü–æ–≥–∏–±–ª–æ', '–°–º–µ—Ä—Ç–Ω–æ—Å—Ç—å %']],[m[41m [m
[32m+[m[32m                           use_container_width=True)[m
[32m+[m[41m            [m
[32m+[m[32m            with col2:[m
[32m+[m[32m                st.write("**–ü–æ —É—Ä–æ–≤–Ω—é —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–∏:**")[m
[32m+[m[32m                high_mortality = dangerous_causes.sort_values('—Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å_%', ascending=False).head(5)[m
[32m+[m[32m                display_mortality = high_mortality.rename(columns={[m
[32m+[m[32m                    '–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è': '–ü—Ä–∏—á–∏–Ω–∞',[m
[32m+[m[32m                    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': '–ü–æ–∂–∞—Ä—ã',[m
[32m+[m[32m                    '–≤—Å–µ–≥–æ_–ø–æ–≥–∏–±–ª–æ': '–ü–æ–≥–∏–±–ª–æ',[m
[32m+[m[32m                    '—Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å_%': '–°–º–µ—Ä—Ç–Ω–æ—Å—Ç—å %'[m
[32m+[m[32m                })[m
[32m+[m[32m                st.dataframe(display_mortality[['–ü—Ä–∏—á–∏–Ω–∞', '–ü–æ–∂–∞—Ä—ã', '–ü–æ–≥–∏–±–ª–æ', '–°–º–µ—Ä—Ç–Ω–æ—Å—Ç—å %']],[m[41m [m
[32m+[m[32m                           use_container_width=True)[m
[32m+[m[41m    [m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∏—á–∏–Ω—ã –ø–æ–∂–∞—Ä–æ–≤ –≤ –¥–∞–Ω–Ω—ã—Ö")[m
[32m+[m
[32m+[m[32mdef analyze_locations(df):[m
[32m+[m[32m    """–ê–Ω–∞–ª–∏–∑ –º–µ—Å—Ç –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è"""[m
[32m+[m[32m    st.subheader("4. –ù–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç—ã–µ –º–µ—Å—Ç–∞ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –ø–æ–∂–∞—Ä–æ–≤")[m
[32m+[m[41m    [m
[32m+[m[32m    if '–æ–±—ä–µ–∫—Ç' in df.columns:[m
[32m+[m[32m        locations_data = df.groupby('–æ–±—ä–µ–∫—Ç').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count'[m
[32m+[m[32m        }).reset_index()[m
[32m+[m[41m        [m
[32m+[m[32m        locations_data = locations_data.sort_values('–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤', ascending=False)[m
[32m+[m[41m        [m
[32m+[m[32m        if not locations_data.empty:[m
[32m+[m[32m            create_chart(locations_data.head(10), 'bar', x='–æ–±—ä–µ–∫—Ç', y='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤',[m
[32m+[m[32m                        title='–¢–æ–ø-10 –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ–∂–∞—Ä–æ–≤')[m
[32m+[m[32m        else:[m
[32m+[m[32m            st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –º–µ—Å—Ç–∞—Ö –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è –ø–æ–∂–∞—Ä–æ–≤")[m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–æ–ª–æ–Ω–∫–∞ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ –ø–æ–∂–∞—Ä–æ–≤")[m
[32m+[m
[32m+[m[32mdef analyze_seasonality(df):[m
[32m+[m[32m    """–ê–Ω–∞–ª–∏–∑ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏"""[m
[32m+[m[32m    st.subheader("5. –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –ø–æ–∂–∞—Ä–æ–≤ (–ø–æ –º–µ—Å—è—Ü–∞–º)")[m
[32m+[m[41m    [m
[32m+[m[32m    if '–º–µ—Å—è—Ü' in df.columns:[m
[32m+[m[32m        monthly_data = df.groupby('–º–µ—Å—è—Ü').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count'[m
[32m+[m[32m        }).reset_index()[m
[32m+[m[41m        [m
[32m+[m[32m        if not monthly_data.empty:[m
[32m+[m[32m            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –Ω–æ–º–µ—Ä–∞ –º–µ—Å—è—Ü–µ–≤ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è[m
[32m+[m[32m            month_names = {[m
[32m+[m[32m                1: '–Ø–Ω–≤–∞—Ä—å', 2: '–§–µ–≤—Ä–∞–ª—å', 3: '–ú–∞—Ä—Ç', 4: '–ê–ø—Ä–µ–ª—å',[m[41m [m
[32m+[m[32m                5: '–ú–∞–π', 6: '–ò—é–Ω—å', 7: '–ò—é–ª—å', 8: '–ê–≤–≥—É—Å—Ç',[m
[32m+[m[32m                9: '–°–µ–Ω—Ç—è–±—Ä—å', 10: '–û–∫—Ç—è–±—Ä—å', 11: '–ù–æ—è–±—Ä—å', 12: '–î–µ–∫–∞–±—Ä—å'[m
[32m+[m[32m            }[m
[32m+[m[32m            monthly_data['–º–µ—Å—è—Ü_–Ω–∞–∑–≤–∞–Ω–∏–µ'] = monthly_data['–º–µ—Å—è—Ü'].map(month_names)[m
[32m+[m[41m            [m
[32m+[m[32m            create_chart(monthly_data, 'line', x='–º–µ—Å—è—Ü_–Ω–∞–∑–≤–∞–Ω–∏–µ', y='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤',[m
[32m+[m[32m                        title='–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –ø–æ–∂–∞—Ä–æ–≤ –ø–æ –º–µ—Å—è—Ü–∞–º')[m
[32m+[m[32m        else:[m
[32m+[m[32m            st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏")[m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –æ –º–µ—Å—è—Ü–∞—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç–∏")[m
[32m+[m
[32m+[m[32mdef analyze_district_dynamics(df):[m
[32m+[m[32m    """–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ —Ä–∞–π–æ–Ω–∞–º"""[m
[32m+[m[32m    st.subheader("6. –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –ø–æ —Ä–∞–π–æ–Ω–∞–º")[m
[32m+[m[41m    [m
[32m+[m[32m    if '—Ä–∞–π–æ–Ω' in df.columns and '–≥–æ–¥' in df.columns:[m
[32m+[m[32m        available_districts = df['—Ä–∞–π–æ–Ω'].unique()[m
[32m+[m[32m        if len(available_districts) > 0:[m
[32m+[m[32m            districts = st.multiselect("–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–π–æ–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞:",[m[41m [m
[32m+[m[32m                                     available_districts,[m[41m [m
[32m+[m[32m                                     default=available_districts[:min(3, len(available_districts))])[m
[32m+[m[41m            [m
[32m+[m[32m            if districts:[m
[32m+[m[32m                filtered_data = df[df['—Ä–∞–π–æ–Ω'].isin(districts)][m
[32m+[m[32m                district_yearly = filtered_data.groupby(['–≥–æ–¥', '—Ä–∞–π–æ–Ω']).agg({[m
[32m+[m[32m                    '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count'[m
[32m+[m[32m                }).reset_index()[m
[32m+[m[41m                [m
[32m+[m[32m                if not district_yearly.empty:[m
[32m+[m[32m                    if PLOTLY_AVAILABLE:[m
[32m+[m[32m                        fig = px.line(district_yearly, x='–≥–æ–¥', y='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤',[m[41m [m
[32m+[m[32m                                     color='—Ä–∞–π–æ–Ω', title='–î–∏–Ω–∞–º–∏–∫–∞ –ø–æ–∂–∞—Ä–æ–≤ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ä–∞–π–æ–Ω–∞–º')[m
[32m+[m[32m                        st.plotly_chart(fig, use_container_width=True)[m
[32m+[m[32m                    else:[m
[32m+[m[32m                        pivot_data = district_yearly.pivot(index='–≥–æ–¥', columns='—Ä–∞–π–æ–Ω', values='–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤')[m
[32m+[m[32m                        st.line_chart(pivot_data)[m
[32m+[m[32m                else:[m
[32m+[m[32m                    st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ä–∞–π–æ–Ω–æ–≤")[m
[32m+[m[32m        else:[m
[32m+[m[32m            st.info("–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —Ä–∞–π–æ–Ω–∞—Ö")[m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –æ —Ä–∞–π–æ–Ω–∞—Ö –∏–ª–∏ –≥–æ–¥–∞—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏")[m
[32m+[m
[32m+[m[32mdef analyze_comparison(df):[m
[32m+[m[32m    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞"""[m
[32m+[m[32m    st.subheader("7. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ–¥–∞ (–ê–ü–ü–ì)")[m
[32m+[m[41m    [m
[32m+[m[32m    if '–≥–æ–¥' in df.columns and '—Ä–∞–π–æ–Ω' in df.columns:[m
[32m+[m[32m        current_year = df['–≥–æ–¥'].max()[m
[32m+[m[32m        previous_year = current_year - 1[m
[32m+[m[41m        [m
[32m+[m[32m        current_data = df[df['–≥–æ–¥'] == current_year].groupby('—Ä–∞–π–æ–Ω').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m            '–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m            '—Ç—Ä–∞–≤–º—ã': 'sum'[m
[32m+[m[32m        })[m
[32m+[m[41m        [m
[32m+[m[32m        previous_data = df[df['–≥–æ–¥'] == previous_year].groupby('—Ä–∞–π–æ–Ω').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count',[m
[32m+[m[32m            '–ø–æ–≥–∏–±–ª–æ': 'sum',[m
[32m+[m[32m            '—Ç—Ä–∞–≤–º—ã': 'sum'[m
[32m+[m[32m        })[m
[32m+[m[41m        [m
[32m+[m[32m        if not current_data.empty and not previous_data.empty:[m
[32m+[m[32m            comparison = pd.DataFrame({[m
[32m+[m[32m                '—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_–ø–æ–∂–∞—Ä—ã': current_data['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'],[m
[32m+[m[32m                '–ø—Ä–æ—à–ª—ã–π_–≥–æ–¥_–ø–æ–∂–∞—Ä—ã': previous_data['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'],[m
[32m+[m[32m                '—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_–ø–æ–≥–∏–±–ª–æ': current_data['–ø–æ–≥–∏–±–ª–æ'],[m
[32m+[m[32m                '–ø—Ä–æ—à–ª—ã–π_–≥–æ–¥_–ø–æ–≥–∏–±–ª–æ': previous_data['–ø–æ–≥–∏–±–ª–æ'],[m
[32m+[m[32m                '—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_—Ç—Ä–∞–≤–º—ã': current_data['—Ç—Ä–∞–≤–º—ã'],[m
[32m+[m[32m                '–ø—Ä–æ—à–ª—ã–π_–≥–æ–¥_—Ç—Ä–∞–≤–º—ã': previous_data['—Ç—Ä–∞–≤–º—ã'][m
[32m+[m[32m            }).fillna(0)[m
[32m+[m[41m            [m
[32m+[m[32m            comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_–ø–æ–∂–∞—Ä–æ–≤'] = comparison['—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_–ø–æ–∂–∞—Ä—ã'] - comparison['–ø—Ä–æ—à–ª—ã–π_–≥–æ–¥_–ø–æ–∂–∞—Ä—ã'][m
[32m+[m[32m            comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_–ø–æ–∂–∞—Ä–æ–≤_%'] = (comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_–ø–æ–∂–∞—Ä–æ–≤'] / comparison['–ø—Ä–æ—à–ª—ã–π_–≥–æ–¥_–ø–æ–∂–∞—Ä—ã'] * 100).round(1)[m
[32m+[m[32m            comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_–ø–æ–≥–∏–±–ª–æ'] = comparison['—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_–ø–æ–≥–∏–±–ª–æ'] - comparison['–ø—Ä–æ—à–ª—ã–π_–≥–æ–¥_–ø–æ–≥–∏–±–ª–æ'][m
[32m+[m[32m            comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_—Ç—Ä–∞–≤–º—ã'] = comparison['—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_—Ç—Ä–∞–≤–º—ã'] - comparison['–ø—Ä–æ—à–ª—ã–π_–≥–æ–¥_—Ç—Ä–∞–≤–º—ã'][m
[32m+[m[41m            [m
[32m+[m[32m            st.write(f"**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ {current_year} –≥–æ–¥–∞ —Å {previous_year} –≥–æ–¥–æ–º:**")[m
[32m+[m[41m            [m
[32m+[m[32m            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—â–∏–µ –∏—Ç–æ–≥–∏[m
[32m+[m[32m            col1, col2, col3 = st.columns(3)[m
[32m+[m[32m            with col1:[m
[32m+[m[32m                total_fires_change = comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_–ø–æ–∂–∞—Ä–æ–≤'].sum()[m
[32m+[m[32m                st.metric("–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–∂–∞—Ä–æ–≤",[m[41m [m
[32m+[m[32m                         f"{comparison['—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_–ø–æ–∂–∞—Ä—ã'].sum():.0f}",[m
[32m+[m[32m                         f"{total_fires_change:+.0f}")[m
[32m+[m[32m            with col2:[m
[32m+[m[32m                total_deaths_change = comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_–ø–æ–≥–∏–±–ª–æ'].sum()[m
[32m+[m[32m                st.metric("–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–≥–∏–±—à–∏—Ö",[m
[32m+[m[32m                         f"{comparison['—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_–ø–æ–≥–∏–±–ª–æ'].sum():.0f}",[m
[32m+[m[32m                         f"{total_deaths_change:+.0f}")[m
[32m+[m[32m            with col3:[m
[32m+[m[32m                total_injuries_change = comparison['–∏–∑–º–µ–Ω–µ–Ω–∏–µ_—Ç—Ä–∞–≤–º—ã'].sum()[m
[32m+[m[32m                st.metric("–ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ—Å—Ç—Ä–∞–¥–∞–≤—à–∏—Ö",[m
[32m+[m[32m                         f"{comparison['—Ç–µ–∫—É—â–∏–π_–≥–æ–¥_—Ç—Ä–∞–≤–º—ã'].sum():.0f}",[m
[32m+[m[32m                         f"{total_injuries_change:+.0f}")[m
[32m+[m[41m            [m
[32m+[m[32m            st.dataframe(comparison, use_container_width=True)[m
[32m+[m[32m        else:[m
[32m+[m[32m            st.info("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ê–ü–ü–ì")[m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ê–ü–ü–ì")[m
[32m+[m
[32m+[m[32mdef predict_fire_trend(df):[m
[32m+[m[32m    """–ü—Ä–æ–≥–Ω–æ–∑ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π –ø–æ–∂–∞—Ä–æ–≤"""[m
[32m+[m[32m    st.subheader("–ü—Ä–æ–≥–Ω–æ–∑ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π –ø–æ–∂–∞—Ä–æ–≤")[m
[32m+[m[41m    [m
[32m+[m[32m    if '–≥–æ–¥' in df.columns:[m
[32m+[m[32m        yearly_stats = df.groupby('–≥–æ–¥').agg({[m
[32m+[m[32m            '–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤': 'count'[m
[32m+[m[32m        }).reset_index()[m
[32m+[m[41m        [m
[32m+[m[32m        if len(yearly_stats) > 1:[m
[32m+[m[32m            current_year = yearly_stats.iloc[-1][m
[32m+[m[32m            previous_year = yearly_stats.iloc[-2][m
[32m+[m[41m            [m
[32m+[m[32m            fires_trend = "üìà –†–∞—Å—Ç—É—â–∞—è" if current_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] > previous_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] else "üìâ –°–Ω–∏–∂–∞—é—â–∞—è—Å—è"[m
[32m+[m[32m            fires_change = ((current_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] - previous_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤']) / previous_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] * 100)[m
[32m+[m[41m            [m
[32m+[m[32m            col1, col2 = st.columns(2)[m
[32m+[m[32m            with col1:[m
[32m+[m[32m                st.metric([m
[32m+[m[32m                    label="–¢—Ä–µ–Ω–¥ –ø–æ–∂–∞—Ä–æ–≤",[m
[32m+[m[32m                    value=fires_trend,[m
[32m+[m[32m                    delta=f"{fires_change:.1f}%"[m
[32m+[m[32m                )[m
[32m+[m[41m            [m
[32m+[m[32m            with col2:[m
[32m+[m[32m                # –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≥–Ω–æ–∑[m
[32m+[m[32m                if len(yearly_stats) > 2:[m
[32m+[m[32m                    avg_growth = yearly_stats['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'].pct_change().mean()[m
[32m+[m[32m                    next_year_pred = current_year['–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_–ø–æ–∂–∞—Ä–æ–≤'] * (1 + avg_growth)[m
[32m+[m[32m                    st.metric([m
[32m+[m[32m                        label="–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–ª–µ–¥. –≥–æ–¥",[m
[32m+[m[32m                        value=f"{next_year_pred:.0f} –ø–æ–∂–∞—Ä–æ–≤",[m
[32m+[m[32m                        delta=f"{avg_growth*100:.1f}%"[m
[32m+[m[32m                    )[m
         else:[m
[31m-            growth = f'{last_gdp / first_gdp:,.2f}x'[m
[31m-            delta_color = 'normal'[m
[31m-[m
[31m-        st.metric([m
[31m-            label=f'{country} GDP',[m
[31m-            value=f'{last_gdp:,.0f}B',[m
[31m-            delta=growth,[m
[31m-            delta_color=delta_color[m
[31m-        )[m
[32m+[m[32m            st.info("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞ (–Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2 –≥–æ–¥–∞)")[m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞")[m
[32m+[m
[32m+[m[32m# –û—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ[m
[32m+[m[32mdef main():[m
[32m+[m[32m    st.title("üî• –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥ –ø–æ–∂–∞—Ä–æ–≤")[m
[32m+[m[41m    [m
[32m+[m[32m    # –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞[m
[32m+[m[32m    st.sidebar.header("–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö")[m
[32m+[m[32m    uploaded_file = st.sidebar.file_uploader("–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø–æ–∂–∞—Ä–∞—Ö",[m[41m [m
[32m+[m[32m                                           type=['xlsx', 'xls'])[m
[32m+[m[41m    [m
[32m+[m[32m    if uploaded_file is not None:[m
[32m+[m[32m        df = load_data(uploaded_file)[m
[32m+[m[41m        [m
[32m+[m[32m        if df is not None:[m
[32m+[m[32m            st.sidebar.success(f"–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã: {len(df)} –∑–∞–ø–∏—Å–µ–π")[m
[32m+[m[41m            [m
[32m+[m[32m            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–∞–Ω–Ω—ã—Ö[m
[32m+[m[32m            with st.expander("üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"):[m
[32m+[m[32m                st.write(f"**–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π:** {len(df)}")[m
[32m+[m[32m                st.write(f"**–ü–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã—Ö:** {df['–≥–æ–¥'].min()} - {df['–≥–æ–¥'].max()}")[m
[32m+[m[32m                if '—Ä–∞–π–æ–Ω' in df.columns:[m
[32m+[m[32m                    st.write(f"**–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–π–æ–Ω–æ–≤:** {df['—Ä–∞–π–æ–Ω'].nunique()}")[m
[32m+[m[41m                [m
[32m+[m[32m                # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–∏—á–∏–Ω–∞—Ö[m
[32m+[m[32m                if '–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è' in df.columns:[m
[32m+[m[32m                    cause_stats = df['–ø—Ä–∏—á–∏–Ω–∞_–æ—á–∏—â–µ–Ω–Ω–∞—è'].value_counts()[m
[32m+[m[32m                    st.write("**–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏—á–∏–Ω:**")[m
[32m+[m[32m                    for cause, count in cause_stats.items():[m
[32m+[m[32m                        st.write(f"- {cause}: {count} ({count/len(df)*100:.1f}%)")[m
[32m+[m[41m                [m
[32m+[m[32m                st.write("**–ü–µ—Ä–≤—ã–µ 5 –∑–∞–ø–∏—Å–µ–π:**")[m
[32m+[m[32m                st.dataframe(df.head(), use_container_width=True)[m
[32m+[m[41m            [m
[32m+[m[32m            # –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–¥–µ–ª—ã[m
[32m+[m[32m            analyze_fire_trends(df)  # 1. –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ –≥–æ–¥–∞–º[m
[32m+[m[32m            st.divider()[m
[32m+[m[41m            [m
[32m+[m[32m            analyze_district_distribution(df)  # 2.1 –†–µ–π—Ç–∏–Ω–≥ —Ä–∞–π–æ–Ω–æ–≤[m
[32m+[m[32m            analyze_district_map(df)  # 2.2 –ö–∞—Ä—Ç–∞ —Ä–∞–π–æ–Ω–æ–≤[m
[32m+[m[32m            st.divider()[m
[32m+[m[41m            [m
[32m+[m[32m            analyze_causes(df)  # 3. –ü—Ä–∏—á–∏–Ω—ã –ø–æ–∂–∞—Ä–æ–≤[m
[32m+[m[32m            st.divider()[m
[32m+[m[41m            [m
[32m+[m[32m            analyze_locations(df)  # 4. –ú–µ—Å—Ç–∞ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è[m
[32m+[m[32m            st.divider()[m
[32m+[m[41m            [m
[32m+[m[32m            analyze_seasonality(df)  # 5. –°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å[m
[32m+[m[32m            st.divider()[m
[32m+[m[41m            [m
[32m+[m[32m            analyze_district_dynamics(df)  # 6. –î–∏–Ω–∞–º–∏–∫–∞ –ø–æ —Ä–∞–π–æ–Ω–∞–º[m
[32m+[m[32m            st.divider()[m
[32m+[m[41m            [m
[32m+[m[32m            analyze_comparison(df)  # 7. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ê–ü–ü–ì[m
[32m+[m[32m            st.divider()[m
[32m+[m[41m            [m
[32m+[m[32m            predict_fire_trend(df)  # –ü—Ä–æ–≥–Ω–æ–∑[m
[32m+[m[41m            [m
[32m+[m[32m    else:[m
[32m+[m[32m        st.info("üëÜ –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –ø–æ–∂–∞—Ä–∞—Ö –¥–ª—è –Ω–∞—á–∞–ª–∞ –∞–Ω–∞–ª–∏–∑–∞")[m
[32m+[m
[32m+[m[32mif __name__ == "__main__":[m
[32m+[m[32m    main()[m
\ No newline at end of file[m
